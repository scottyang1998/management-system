# Git的使用

## 实验目的

1. 学习 Git 软件的安装
2. 学习 Git 的简单使用，增加文件，提交，创建分支，增加远程，下拉、上推，合并
3. 学习 Git 的冲突处理 

## 实验平台

1.  Windows 10

## 实验前准备

1.  下载安装Git
2.  查阅Git相关基础知识和命令
3.  掌握Markdown语言的知识

## 实验内容

### Git的安装

#### 下载

下载地址：下载地址：https://www.git-scm.com/download/

![Snipaste_2020-05-18_16-40-26](C:\Users\杨道潮\Desktop\体系结构\3117005001-杨道潮-体系结构\实验一：Git的使用\imgs\Snipaste_2020-05-18_16-40-26.png)

#### 安装

1. 点开exe文件

![Snipaste_2020-05-18_16-42-29](C:\Users\杨道潮\Desktop\体系结构\3117005001-杨道潮-体系结构\实验一：Git的使用\imgs\Snipaste_2020-05-18_16-42-29.png)

2. 点击下一步，安装相应的组件

![Snipaste_2020-05-18_17-22-08](C:\Users\杨道潮\Desktop\体系结构\3117005001-杨道潮-体系结构\实验一：Git的使用\imgs\Snipaste_2020-05-18_17-22-08.png)

3. 选择默认编辑器

![Snipaste_2020-05-18_17-30-49](C:\Users\杨道潮\Desktop\体系结构\3117005001-杨道潮-体系结构\实验一：Git的使用\imgs\Snipaste_2020-05-18_17-30-49.png)

4. 配置路径

![Snipaste_2020-05-18_17-31-30](C:\Users\杨道潮\Desktop\体系结构\3117005001-杨道潮-体系结构\实验一：Git的使用\imgs\Snipaste_2020-05-18_17-31-30.png)

5. 选择后台传输方式

![Snipaste_2020-05-18_17-31-46](C:\Users\杨道潮\Desktop\体系结构\3117005001-杨道潮-体系结构\实验一：Git的使用\imgs\Snipaste_2020-05-18_17-31-46.png)

6. Git处理文本方式，默认

![Snipaste_2020-05-18_17-32-04](C:\Users\杨道潮\Desktop\体系结构\3117005001-杨道潮-体系结构\实验一：Git的使用\imgs\Snipaste_2020-05-18_17-32-04.png)

7. 选择终端，默认

![Snipaste_2020-05-18_17-32-19](C:\Users\杨道潮\Desktop\体系结构\3117005001-杨道潮-体系结构\实验一：Git的使用\imgs\Snipaste_2020-05-18_17-32-19.png)

8. 额外选项

![Snipaste_2020-05-18_17-32-37](C:\Users\杨道潮\Desktop\体系结构\3117005001-杨道潮-体系结构\实验一：Git的使用\imgs\Snipaste_2020-05-18_17-32-37.png)

9. 安装中

![Snipaste_2020-05-18_17-32-59](C:\Users\杨道潮\Desktop\体系结构\3117005001-杨道潮-体系结构\实验一：Git的使用\imgs\Snipaste_2020-05-18_17-32-59.png)

10. 完成安装

![Snipaste_2020-05-18_17-33-21](C:\Users\杨道潮\Desktop\体系结构\3117005001-杨道潮-体系结构\实验一：Git的使用\imgs\Snipaste_2020-05-18_17-33-21.png)

### Git的简单使用

#### 打开Git GUI

1. 在数据目录下，右键点击Git GUI here，这样一个仓库就创建完成了

![Snipaste_2020-05-18_17-57-43](C:\Users\杨道潮\Desktop\体系结构\3117005001-杨道潮-体系结构\实验一：Git的使用\imgs\Snipaste_2020-05-18_17-57-43.png)

2. 图形界面如下



![Snipaste_2020-05-18_18-00-21](C:\Users\杨道潮\Desktop\体系结构\3117005001-杨道潮-体系结构\实验一：Git的使用\imgs\Snipaste_2020-05-18_18-00-21.png)

#### 配置个人信息

1. 点击导航栏，Edit--options，可以看到配置信息

2. 填写以下信息，用户名、邮箱地址、以及字符编码选择UTF-8

![Snipaste_2020-05-18_18-20-10](C:\Users\杨道潮\Desktop\体系结构\3117005001-杨道潮-体系结构\实验一：Git的使用\imgs\Snipaste_2020-05-18_18-20-10.png)

#### 

#### 增加文件

1. 在数据目录下新增了文件后，需要把文件移入暂存区

使用命令git add ，注意，可反复多次使用，添加多个文件；

或者在Git GUI界面按ctrl+i

使得Unstaged Changes的文件移动到Stages Changes

![Snipaste_2020-05-18_21-28-27](C:\Users\杨道潮\Desktop\体系结构\3117005001-杨道潮-体系结构\实验一：Git的使用\imgs\Snipaste_2020-05-18_21-28-27.png)

#### 提交

1. 当文件添加后

此时文件处于暂存区，如果需要移入本地仓库，需要用到git命令git commit

或者在git gui点击commit或者ctrl+enter

注意：commit文件必须在Commit Message写备注文字

![Snipaste_2020-05-18_21-38-43](C:\Users\杨道潮\Desktop\体系结构\3117005001-杨道潮-体系结构\实验一：Git的使用\imgs\Snipaste_2020-05-18_21-38-43.png)

#### 创建分支

1. 在目录下右键Git Gui，点击菜单栏上的 Brand，选择 Create 

![Snipaste_2020-05-12_22-47-20](C:\Users\杨道潮\Desktop\体系结构\3117005001-杨道潮-体系结构\imgs\Snipaste_2020-05-12_22-47-20.png)

2. 新增分支名，如git

![Snipaste_2020-05-12_23-07-23](C:\Users\杨道潮\Desktop\体系结构\3117005001-杨道潮-体系结构\imgs\Snipaste_2020-05-12_23-07-23.png)

3. 新增分支后打开Branch-Checkout，可以看到分支情况并切换分支

![Snipaste_2020-05-12_23-13-16](C:\Users\杨道潮\Desktop\体系结构\3117005001-杨道潮-体系结构\imgs\Snipaste_2020-05-12_23-13-16.png)

4. 切换分支后可以在分支添加功能， 当我们在新的分支完成工作有，需要把新的任务合并到主分支。

\1. 切换回主分支
       \2. 选择菜单 Merge 。LocalMerge 可以看到分支和主分支合并了

![Snipaste_2020-05-12_23-17-07](C:\Users\杨道潮\Desktop\体系结构\3117005001-杨道潮-体系结构\imgs\Snipaste_2020-05-12_23-17-07.png)

#### 增加远程

1. 打开Git GUI - Remote - Add
2. 填上备份仓库名和备份地址，Further Action选择第二个：初始化远程仓库并PUSH

![image-20200416133719331](C:\Users\杨道潮\AppData\Roaming\Typora\typora-user-images\image-20200416133719331.png)

3. 在上一步提交后，push不成功

![image-20200416134130793](C:\Users\杨道潮\AppData\Roaming\Typora\typora-user-images\image-20200416134130793.png)

4. 尝试自己在备份仓库新建git仓库

5. 在备份目录下使用git bash命令行

> $git init

6. 再回到Git GUI打开 Remote - Add，Further Action选择第一个：不初始化仓库，又弹出以下报错

> mote: error: By default, updating the current branch in a non-bare repository
>
> remote: error: is denied, because it will make the index and work tree inconsistent
>
> [remote rejected] master -> master (branch is currently checked out)

7. 问题分析

​	如果使用了git init初始化，则远程仓库的目录下，也包含work tree，当本地仓库向远程仓库push时, 如果远程仓库正在push的分支上（如果当时不在push的分支，就没有问题）, 那么push后的结果不会反应在work tree上,  也即在远程仓库的目录下对应的文件还是之前的内容。

8. 解决办法

9. 这是由于git默认拒绝了push操作，需要进行设置，修改.git/config文件后面添加如下代码：

> [receive]
> denyCurrentBranch = ignore

10. 无法查看push后的git中文件的原因与解决方法

在初始化远程仓库时最好使用如下命令

> git --bare init

11. 重新操作新增远程步骤，打开Git GUI后commit和push，结果截图如下

![image-20200416140202186](C:\Users\杨道潮\AppData\Roaming\Typora\typora-user-images\image-20200416140202186.png)



#### 下拉



#### 上推



#### 合并



#### 冲突处理

1.  打开Git GUI，Branch -- Create，新建分支branch1

![Snipaste_2020-05-14_22-03-53](C:\Users\杨道潮\Desktop\体系结构\3117005001-杨道潮-体系结构\imgs\Snipaste_2020-05-14_22-03-53.png)

2. 新建分支branch2 

![Snipaste_2020-05-14_22-09-03](C:\Users\杨道潮\Desktop\体系结构\3117005001-杨道潮-体系结构\imgs\Snipaste_2020-05-14_22-09-03.png)

3.  Merge -- Localmerge，先选择master分支和branch1分支合并，合并成功

![Snipaste_2020-05-14_22-12-26](C:\Users\杨道潮\Desktop\体系结构\3117005001-杨道潮-体系结构\imgs\Snipaste_2020-05-14_22-12-26.png)

4.  再选择master分支和branch2分支合并，合并也成功

![Snipaste_2020-05-14_22-12-50](C:\Users\杨道潮\Desktop\体系结构\3117005001-杨道潮-体系结构\imgs\Snipaste_2020-05-14_22-12-50.png)

5.  此时看到当前的分支历史如下图

![Snipaste_2020-05-14_22-13-28](C:\Users\杨道潮\Desktop\体系结构\3117005001-杨道潮-体系结构\imgs\Snipaste_2020-05-14_22-13-28.png)

6.  切换分支branch1，新建txt文件branch，内容为“第一个分支的新文件”，branch1文件再增加一行
7. 同理切换分支branch2，新建新建txt文件branch，内容为“第二个分支的新文件”，branch2文件再增加一行

![Snipaste_2020-05-14_22-33-54](C:\Users\杨道潮\Desktop\体系结构\3117005001-杨道潮-体系结构\imgs\Snipaste_2020-05-14_22-33-54.png)

![Snipaste_2020-05-14_22-40-06](C:\Users\杨道潮\Desktop\体系结构\3117005001-杨道潮-体系结构\imgs\Snipaste_2020-05-14_22-40-06.png)

8.   选择master分支和branch1分支合并，合并成功

![Snipaste_2020-05-14_22-47-20](C:\Users\杨道潮\Desktop\体系结构\3117005001-杨道潮-体系结构\imgs\Snipaste_2020-05-14_22-47-20.png)

9.  但master分支和branch2分支合并，合并失败，错误提示branch.txt合并冲突

![Snipaste_2020-05-14_22-47-48](C:\Users\杨道潮\Desktop\体系结构\3117005001-杨道潮-体系结构\imgs\Snipaste_2020-05-14_22-47-48.png)

10.  再找原因，原来是branch1中的branch.txt内容和branch2的内容不一致，系统不知道如何合并，要我们自行取舍

![Snipaste_2020-05-14_23-02-01](C:\Users\杨道潮\Desktop\体系结构\3117005001-杨道潮-体系结构\imgs\Snipaste_2020-05-14_23-02-01.png)

11.  将文件内容的其他提示删去，留下“第一个分支的新文件”“新增分支2文件”即可解决冲突

![Snipaste_2020-05-14_23-18-08](C:\Users\杨道潮\Desktop\体系结构\3117005001-杨道潮-体系结构\imgs\Snipaste_2020-05-14_23-18-08.png)







## 实验总结